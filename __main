import json
import datetime

#local code import
from password_genertor import password_generator
import menu_functions

logged = False
logowanie = ''
login = ''
password = ''
menu_functions.menu()
logowanie = input('Wybierz 1 lub 0: ')

while logged == False and logowanie == '1':
    try:
        with open('login_password.txt') as file:
            data = file.read()
            users = json.loads(data)
    except:
        print('Brak pliku z danymi logowania')

    if logowanie == '1':
        login = input('Podaj swój login: ')
        password = ''

        if login in users:
            password = input('Podaj hasło: ')
            if login in users and users[login] == password:
                print('Zalogowałeś się')
                logged = True
                print('Koniec logowania')
            else:
                print('Niepoprawne dane')
            
        elif login not in users:
            print('Nie ma takiego użytkownika. Czy chcesz utworzyć konto ?')
            answer = input('Y/N ? ')
            
            if answer == 'Y':
                login = login
                #input('Podaj swój nowy login: ')
                answer_2 = input('Podaj swoje hasło (Y) lub wybierz automatyczne (N)\n' )

                if answer_2 == 'N':
                    password = password_generator()
                    
                elif answer_2 == 'Y':
                    password = input('Podaj swoje nowe hasło: ')
                    
                new_data = {login:password} 
                users.update(new_data)
    
        
        with open('login_password.txt','w') as file:
            file.write(json.dumps(users))

    
print('Wyłaczono')
